---
import ButtonLink from '../ui/ButtonLink.astro';
import ModeSwitch from '../ui/ModeSwitch.astro';
const sitename = Astro.props;
const currentPath = Astro.url.pathname;

//const pathname = new URL(Astro.request.url).pathname;
//const currentPath = pathname.slice(1);

// mobile-menu data and logic
const menuId = 'mobile-menu-2';
const buttonId = 'mobile-menu-button';

// Menu items array for cleaner markup
const menuItems = [
  { href: '/', label: 'Home' },
  { href: '/about/', label: 'About' },
  { href: '/services/', label: 'Services' },
  { href: '/contact/', label: 'Contact' },
];

function isActive(href) {
  // Remove trailing slash from both for comparison
  const normalizedCurrent = currentPath.replace(/\/$/, '');
  const normalizedHref = href.replace(/\/$/, '');
  return normalizedCurrent === normalizedHref;
}
---
<header class="p-0 m-0 w-full">
<nav aria-label="Main navigation" class="bg-base-100 py-2">
  <div class="flex flex-wrap items-center justify-between max-w-screen-xl px-4 mx-auto">

    <!-- Logo -->
    <a href="/" aria-label="Home" class="flex items-center">
      <img src="/img/newlogo2.png" class="h-8 mr-3 md:h-12 lg:h-16 2xl:h-20" alt="Return to Homepage || Rule The Web" />
      <span class="self-center text-xl md:text-3xl font-semibold whitespace-nowrap text-base-900">Rule The Web</span>
    </a>

    <!-- Right side buttons -->
    <div class="flex items-center lg:order-2 md:gap-4">
      <ModeSwitch />
      <span class="hidden md:inline-flex">
      <ButtonLink href="/contact" variant="secondary" size="sm" mobileHidden>Get Started</ButtonLink>
      </span>
      <!-- Hamburger button -->
      <button
        id="mobile-toggle"
        class="inline-flex items-center p-2 ml-1 text-sm text-base-600 rounded-lg lg:hidden hover:bg-base-200 focus:outline-none focus:ring-2 focus:ring-base-300"
        aria-label="Toggle menu"
        aria-expanded="false"
      >
        <span class="sr-only">Open main menu</span>
        <svg id="hamburger" class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path>
        </svg>
        <svg id="close" class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
        </svg>
      </button>
    </div>

    <!-- Menu (hidden on mobile) -->
    <div id="mobile-menu" class="hidden w-full lg:flex lg:w-auto lg:order-1">
    <ul class="flex flex-col mt-4 text-lg lg:flex-row lg:space-x-8 lg:mt-0">
      {menuItems.map(item => {
        const active = isActive(item.href);
        return (
          <li class="lg:bg-transparent">
            <a
              href={item.href}
              class={`block py-2 pl-3 pr-4 border-b border-base-300 lg:border-0 lg:p-0 ${active ? "active" : "text-base-700"}`}
              aria-current={active ? "page" : undefined}
            >
              {item.label}
            </a>
          </li>
        );
      })}
    </ul>
  </div>
  </div>
</nav>
</header>
